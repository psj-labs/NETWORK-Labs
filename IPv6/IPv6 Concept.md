## 1. IPv6 기본 개념

IPv6는 **IPv4 주소 고갈 문제 해결과 네트워크 구조 단순화**를 위해 등장한 차세대 IP 프로토콜이다.

**한줄 정의**  
→ **IPv6는 “128bit 주소를 사용해 거의 무한한 단말 연결을 가능하게 만든 차세대 인터넷 프로토콜”이다.**

주소 길이 : **128bit (16 Byte)**  
표기법 : **16진수 4자리 단위 8블록, `:` 구분**

예)  
2001:0db8:0000:0000:0000:0000:0000:0001

## 2. IPv6 주소 압축 규칙

압축 규칙

① 각 블록의 **선행 0 제거 가능**  
② 연속된 0 블록은 `::`로 **1회만 압축 가능**

예)

2001:0db8:0000:0000:0000:0000:0000:0001  
→ 2001:db8:0:0:0:0:0:1  
→ 2001:db8::1

## 3. IPv6 특수 주소

### ■ 불특정 주소 (Unspecified Address)
표기 : `::`

의미
- IPv6 주소 미할당 상태
- DHCPv6 초기 요청 출발지 주소

IPv4 대응 : `0.0.0.0`


### ■ 루프백 주소 (Loopback)
표기 : `::1`

의미
- 자기 자신 테스트

사용 예  
ping ::1

IPv4 대응 : `127.0.0.1`


### ■ 링크 로컬 주소 (Link-Local)
대역 : `fe80::/10`

특징
- 인터페이스 자동 생성
- 동일 링크 범위 통신 전용
- 라우터 통과 불가
- **NDP 기본 통신 주소**
- NDP(Neighbor Discovery Protocol)는 IPv6에서 “IP ↔ MAC 주소 매핑 + 라우터 발견 + 주소 중복 검사”를 담당하는 핵심 제어 프로토콜이다.



### ■ 멀티캐스트 주소
대역 : `ff00::/8`

특징
- IPv4 Broadcast 대체
- 1:N 그룹 통신

대표 예

ff02::1 → 모든 노드  
ff02::2 → 모든 라우터  

## 4. IPv6 주소 유형

### ■ Unicast (유니캐스트)

1:1 통신


### ■ Multicast (멀티캐스트)

1:N 그룹 통신


### ■ Anycast (애니캐스트)

동일 주소를 여러 노드에 할당 후  
**라우팅 기준 가장 가까운 노드 1곳으로 전달**

사용 예
- Root DNS
- Google DNS (8.8.8.8)
- Cloudflare DNS (1.1.1.1)

## 5. IPv6 주소 할당 방식

### ■ SLAAC(Stateless Address Autoconfiguration)
- #### "SLAAC는 IPv6에서 “라우터 광고(RA)만 받고 DHCP 없이 스스로 IP 주소를 자동 생성하는 방식”이다."


- ICMPv6 RA 기반 자동 주소 설정
- DHCP 서버 불필요
- 단말 자율 주소 생성

---

### ■ DHCPv6

- IPv4 DHCP와 동일 개념
- 중앙 서버에서 주소 할당 관리

---

### ■ Dual Stack
- #### Dual Stack은 “한 네트워크 장비가 IPv4와 IPv6를 동시에 운용하는 공존 전환 방식”이다.
- - Dual Stack은 한 장비가 IPv4와 IPv6 두 프로토콜을 동시에 온전히 수행하는 하이브리드 공존 구조다.
- (IPv6 패킷이 IPv4 구간을 통과할 때는 Dual Stack이 아니라 터널링 방식으로 IPv4 헤더 안에 캡슐화 된다)

- IPv4 + IPv6 동시 사용
- 현재 실무 표준 운영 구조

## 6. IPv6 기본 헤더 구조

IPv6 헤더 길이 : **고정 40 Byte**

[ IPv6 Header ]
 ```text
────────────────────────────────────────────────────────────
| Version | Traffic Class |       Flow Label (20bit)       |
────────────────────────────────────────────────────────────
| Payload Length | Next Header | Hop Limit                 |
────────────────────────────────────────────────────────────
|                 Source IPv6 Address                      |
────────────────────────────────────────────────────────────
|               Destination IPv6 Address                   |
────────────────────────────────────────────────────────────
 ```
특징

- 헤더 체크섬 제거
- 옵션 제거 → **확장 헤더 체계 도입**
- Fragment는 송신자 단독 수행
- 라우터 Fragment 금지

## 7. 확장 헤더

옵션 기능은 확장 헤더로 분리

대표 확장 헤더

- Hop-by-Hop Options
  → 모든 라우터가 반드시 확인해야 하는 제어용 옵션 전달 헤더

- Routing Header
  → 패킷이 지나갈 경유지 라우터 경로를 지정하는 헤더

- Fragment Header
  → IPv6에서 단말이 직접 수행하는 패킷 단편화 정보 헤더

- Destination Options
  → 최종 목적지 또는 특정 중간 노드에게만 전달할 옵션 정보 헤더

- Authentication Header (AH)
  → IPsec 인증용 헤더, 송신자 인증 및 무결성 검증 담당

- ESP (IPsec)
  → IPsec 암호화 헤더, 페이로드 기밀성 보호 + 선택적 무결성 제공
  
**체인 구조**
- #### 체인구조란 IPv6 패킷에서 확장 헤더들이 연결 리스트처럼 순서대로 이어져 최종 상위 프로토콜까지 도달하는 구조다.

IPv6 Header  
→ Ext Header  
→ Ext Header  
→ 상위 프로토콜(TCP/UDP/ICMPv6)

## 8. ICMPv6

IPv6 제어 전담 프로토콜

기능

- 오류 보고
- 네트워크 진단
- **PMTUD 수행**
- **NDP 수행 (ARP 대체)**
- **라우터 탐색**
- **SLAAC 제어**

→ **IPv6 통신 필수 코어 프로토콜**

## 9. Flow Label

 ```text

IPv6 기본 헤더(40 bytes)
┌───────────────┬─────────┬───────────────┐
│ Version(4)    │ TC(8)   │ Flow Label(20)│
└───────────────┴─────────┴───────────────┘
 ```


20bit 식별 필드

목적

- 동일 트래픽 흐름 식별
- QoS 적용
- 로드밸런싱 보조

주의

Flow Label 자체는  
세션, 연결 상태 관리 기능 없음

## 10. NAT

IPv6는 **NAT 기본 비사용**

- 모든 단말이 글로벌 유니캐스트 IP 직접 사용
- 종단 간 연결(End-to-End) 복원
- **방화벽 필수 설계**

## 11. DNS + Anycast

DNS 서버는 Anycast 구조 채택

구조

동일 IP  
→ 전 세계 다중 서버 배치  
→ 최단 거리 서버 자동 선택

효과

- 응답 지연 최소화
- DDoS 분산
- 장애 자동 회피

## 12. 보안 포인트

IPv6 주요 공격 벡터

- **RA Spoofing**
- **NDP Spoofing**
- **SLAAC Spoofing**
- **ICMPv6 Flood**
- **IPv6 방화벽 정책 미적용 우회**
