# SSH Packet Structure (Current Standard – SSH-2)

```text
┌──────────────────────────────────────────────────────────────────────────────┐
│                            Packet Length (4 bytes)                           │
├──────────────────────────────────────────────────────────────────────────────┤
│                           Padding Length (1 byte)                            │
├──────────────────────────────────────────────────────────────────────────────┤
│                                   Payload                                    │
│                        (Message Type + Message Data)                         │
├──────────────────────────────────────────────────────────────────────────────┤
│                         Random Padding (4 ~ 255 bytes)                       │
├──────────────────────────────────────────────────────────────────────────────┤
│                     MAC / Auth Tag (variable, optional)                      │
└──────────────────────────────────────────────────────────────────────────────┘

Packet Length
 : 패킷 전체 길이 (Padding Length + Payload + Padding + MAC 포함)

Padding Length
 : 패딩 길이 값

Payload
 : 실제 SSH 메시지 데이터 영역
   - 첫 1 byte → Message Type
   - 이후 → 인증, 채널 데이터, 명령 실행, 파일 전송 데이터 등

Random Padding
 : 블록 암호 정렬 + 트래픽 패턴 은폐를 위한 무작위 패딩 (4 ~ 255 bytes)

MAC / Auth Tag
 : 무결성 검증 필드
   - HMAC-SHA2 등 MAC 알고리즘 사용
   - 위·변조 탐지 목적
   - CRC 미사용 (SSH-1 전용 필드)

────────────────────────────────────────────────────────────────────────────────
                             Encryption Coverage
────────────────────────────────────────────────────────────────────────────────

Encrypted:
  [ Padding Length + Payload + Random Padding ]

Not Encrypted:
  Packet Length

MAC:
  암호화된 전체 데이터 기반 무결성 계산
