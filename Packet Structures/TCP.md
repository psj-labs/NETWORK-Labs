# TCP Header Structure (Base 20 bytes)

```text
################################################################################
                           TCP Header (Base 20 bytes)
################################################################################

┌──────────────────────────┬──────────────────────────┐
│        Source Port       │      Destination Port    │
│          (2 bytes)       │         (2 bytes)        │
└──────────────────────────┴──────────────────────────┘

┌──────────────────────────────────────────────────────┐
│                Sequence Number (4 bytes)             │
└──────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────┐
│            Acknowledgment Number (4 bytes)           │
└──────────────────────────────────────────────────────┘

┌──────────────────────────┬──────────────────────────┐
│     Data Offset / Reserved / Flags   │  Window Size │
│                   (2 bytes)          │   (2 bytes)  │
└──────────────────────────┴──────────────────────────┘

┌──────────────────────────┬──────────────────────────┐
│           Checksum       │        Urgent Pointer    │
│          (2 bytes)       │         (2 bytes)        │
└──────────────────────────┴──────────────────────────┘

┌──────────────────────────────────────────────────────┐
│                     Options (variable)               │
└──────────────────────────────────────────────────────┘


Source Port
 : 출발지 포트
   예시 → 53622

Destination Port
 : 목적지 포트
   예시 → 443 (HTTPS)

Sequence Number
 : 스트림 기준 **첫 전송 바이트의 위치 좌표**
   예시 → 12345678
   의미 → 이 세그먼트 데이터는
           TCP 스트림 12,345,678번째 바이트부터 시작

Acknowledgment Number
 : 누적 ACK — **다음으로 받고 싶은 바이트 번호**
   예시 → 87654321
   의미 → 0 ~ 87,654,320 바이트까지 연속 수신 완료
           다음 데이터는 87,654,321부터 전송 요청

Data Offset (4 bits)
 : TCP 헤더 길이 (32-bit word 단위)
   예시 → 5 → 5 × 4 = 20 bytes (옵션 없음, 기본 헤더)

Reserved
 : 예약 비트 (현재 사용 안 함)

Flags (Control Bits)
 : 세그먼트 제어 신호

   주요 플래그
   - SYN : 연결 설정 시작
   - ACK : 응답 확인 존재
   - FIN : 정상 연결 종료
   - RST : 강제 종료
   - PSH : 즉시 상위계층 전달 요청
   - URG : 긴급 데이터 포함

   예시 → SYN = 1, ACK = 0
   의미 → TCP 연결 시작 패킷 (3-way handshake 1단계)

Window Size
 : 수신 윈도우 크기 (흐름 제어 기준)
   예시 → 64240
   의미 → “내가 64,240 바이트까지 추가 수신 가능”

Checksum
 : TCP 전송 무결성 검증 값
   계산 범위 → 의사헤더 + TCP 헤더 + TCP 데이터

Urgent Pointer
 : URG 플래그 설정 시 긴급 데이터의 마지막 위치
   실무 사용 → 거의 없음

Options
 : TCP 확장 옵션 필드

   주요 옵션
   - MSS            : 최대 세그먼트 크기
   - Window Scale  : 윈도우 크기 확장
   - SACK Permitted: 선택 ACK 허용
   - Timestamp     : RTT 측정 및 재전송 보호
